openapi: 3.0.3
info:
  title: Operacoes Approval Flow
  version: 1.0.0
servers:
  - url: https://api.example.com
paths:
  /chamados:
    post:
      summary: Criar chamado em Operacoes
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tipo
                - departamento
                - titulo
              properties:
                tipo:
                  type: string
                  description: Tipo de chamado (compras, manutencao, etc)
                departamento:
                  type: string
                  description: Departamento de origem (ex: operacoes)
                titulo:
                  type: string
                descricao:
                  type: string
      responses:
        "201":
          description: Chamado criado com status inicial correto
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  status:
                    type: string
                  aprovacoes_pendentes:
                    type: integer
  /aprovacoes:
    get:
      summary: Listar aprovacoes pendentes
      parameters:
        - in: query
          name: status
          schema:
            type: string
            enum: [pendente]
        - in: query
          name: departamento
          schema:
            type: string
      responses:
        "200":
          description: Lista de aprovacoes pendentes
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    chamado_id:
                      type: string
                    nivel:
                      type: integer
                    papel_requerido:
                      type: string
                    status:
                      type: string
  /aprovacoes/{aprovacaoId}/aprovar:
    post:
      summary: Aprovar uma aprovacao pendente
      parameters:
        - in: path
          name: aprovacaoId
          required: true
          schema:
            type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                comentario:
                  type: string
      responses:
        "200":
          description: Aprovacao registrada e status do chamado atualizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  aprovacao_status:
                    type: string
                  chamado_status:
                    type: string
